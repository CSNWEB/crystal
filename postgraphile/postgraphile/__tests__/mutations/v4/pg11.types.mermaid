%%{init: {'themeVariables': { 'fontSize': '12px'}}}%%
graph TD
    classDef path fill:#eee,stroke:#000,color:#000
    classDef plan fill:#fff,stroke-width:1px,color:#000
    classDef itemplan fill:#fff,stroke-width:2px,color:#000
    classDef unbatchedplan fill:#dff,stroke-width:1px,color:#000
    classDef sideeffectplan fill:#fcc,stroke-width:2px,color:#000
    classDef bucket fill:#f6f6f6,color:#000,stroke-width:2px,text-align:left


    %% plan dependencies
    Object30{{"Object[30∈0]<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Access28{{"Access[28∈0]<br />ᐸ3.pgSettingsᐳ"}}:::plan
    Access29{{"Access[29∈0]<br />ᐸ3.withPgClientᐳ"}}:::plan
    Access28 & Access29 --> Object30
    __Value3["__Value[3∈0]<br />ᐸcontextᐳ"]:::plan
    __Value3 --> Access28
    __Value3 --> Access29
    __Value0["__Value[0∈0]"]:::plan
    __Value5["__Value[5∈0]<br />ᐸrootValueᐳ"]:::plan
    Constant98{{"Constant[98∈0]<br />ᐸ12ᐳ"}}:::plan
    Constant99{{"Constant[99∈0]<br />ᐸ'postgraphile_test_authenticator'ᐳ"}}:::plan
    Constant100{{"Constant[100∈0]<br />ᐸ'pg11'ᐳ"}}:::plan
    Constant111{{"Constant[111∈0]<br />ᐸ[ '2098288669218571759', '2098288669218571760', '20982886692ᐳ"}}:::plan
    Constant112{{"Constant[112∈0]<br />ᐸ[Object: null prototype] { a: 1 }ᐳ"}}:::plan
    Constant105{{"Constant[105∈0]<br />ᐸ'postgraphile_test_visitor'ᐳ"}}:::plan
    Constant106{{"Constant[106∈0]<br />ᐸ'c'ᐳ"}}:::plan
    PgInsertSingle72[["PgInsertSingle[72∈6]<br />ᐸtypes(regrole,regnamespace,bigint_domain_array_domain,domain_constrained_compound_type)ᐳ"]]:::sideeffectplan
    Object75{{"Object[75∈6]<br />ᐸ{pgSettings,withPgClient}ᐳ"}}:::plan
    Constant113{{"Constant[113∈6]<br />ᐸ[ '2098288669218571759', '2098288669218571760', '20982886692ᐳ"}}:::plan
    Constant114{{"Constant[114∈6]<br />ᐸ[Object: null prototype] { a: 1 }ᐳ"}}:::plan
    Object75 & Constant105 & Constant106 & Constant113 & Constant114 --> PgInsertSingle72
    Access73{{"Access[73∈6]<br />ᐸ3.pgSettingsᐳ"}}:::plan
    Access74{{"Access[74∈6]<br />ᐸ3.withPgClientᐳ"}}:::plan
    Access73 & Access74 --> Object75
    __Value3 --> Access73
    __Value3 --> Access74
    Object76{{"Object[76∈6]<br />ᐸ{result}ᐳ"}}:::plan
    PgInsertSingle72 --> Object76
    PgUpdateSingle27[["PgUpdateSingle[27∈1]<br />ᐸtypes(id;regrole,regnamespace,bigint_domain_array_domain,domain_constrained_compound_type)ᐳ"]]:::sideeffectplan
    Object30 & Constant98 & Constant99 & Constant100 & Constant111 & Constant112 --> PgUpdateSingle27
    Object31{{"Object[31∈1]<br />ᐸ{result}ᐳ"}}:::plan
    PgUpdateSingle27 --> Object31
    PgSelect40[["PgSelect[40∈3]<br />ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ"]]:::plan
    PgClassExpression39{{"PgClassExpression[39∈3]<br />ᐸ__types__....ound_type”ᐳ"}}:::plan
    Object30 & PgClassExpression39 --> PgSelect40
    PgSelect85[["PgSelect[85∈8]<br />ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ"]]:::plan
    PgClassExpression84{{"PgClassExpression[84∈8]<br />ᐸ__types__....ound_type”ᐳ"}}:::plan
    Object75 & PgClassExpression84 --> PgSelect85
    PgClassExpression34{{"PgClassExpression[34∈3]<br />ᐸ__types__.”id”ᐳ"}}:::plan
    PgUpdateSingle27 --> PgClassExpression34
    PgClassExpression35{{"PgClassExpression[35∈3]<br />ᐸ__types__.”regrole”ᐳ"}}:::plan
    PgUpdateSingle27 --> PgClassExpression35
    PgClassExpression36{{"PgClassExpression[36∈3]<br />ᐸ__types__....namespace”ᐳ"}}:::plan
    PgUpdateSingle27 --> PgClassExpression36
    PgClassExpression37{{"PgClassExpression[37∈3]<br />ᐸ__types__....ay_domain”ᐳ"}}:::plan
    PgUpdateSingle27 --> PgClassExpression37
    PgUpdateSingle27 --> PgClassExpression39
    First44{{"First[44∈3]"}}:::plan
    PgSelect40 --> First44
    PgSelectSingle45{{"PgSelectSingle[45∈3]<br />ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ"}}:::plan
    First44 --> PgSelectSingle45
    PgClassExpression79{{"PgClassExpression[79∈8]<br />ᐸ__types__.”id”ᐳ"}}:::plan
    PgInsertSingle72 --> PgClassExpression79
    PgClassExpression80{{"PgClassExpression[80∈8]<br />ᐸ__types__.”regrole”ᐳ"}}:::plan
    PgInsertSingle72 --> PgClassExpression80
    PgClassExpression81{{"PgClassExpression[81∈8]<br />ᐸ__types__....namespace”ᐳ"}}:::plan
    PgInsertSingle72 --> PgClassExpression81
    PgClassExpression82{{"PgClassExpression[82∈8]<br />ᐸ__types__....ay_domain”ᐳ"}}:::plan
    PgInsertSingle72 --> PgClassExpression82
    PgInsertSingle72 --> PgClassExpression84
    First89{{"First[89∈8]"}}:::plan
    PgSelect85 --> First89
    PgSelectSingle90{{"PgSelectSingle[90∈8]<br />ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ"}}:::plan
    First89 --> PgSelectSingle90
    PgClassExpression46{{"PgClassExpression[46∈5]<br />ᐸ__frmcdc_d...pe_1__.”a”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression46
    PgClassExpression47{{"PgClassExpression[47∈5]<br />ᐸ__frmcdc_d...pe_1__.”b”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression47
    PgClassExpression48{{"PgClassExpression[48∈5]<br />ᐸ__frmcdc_d...pe_1__.”c”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression48
    PgClassExpression49{{"PgClassExpression[49∈5]<br />ᐸ__frmcdc_d...pe_1__.”d”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression49
    PgClassExpression50{{"PgClassExpression[50∈5]<br />ᐸ__frmcdc_d...pe_1__.”e”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression50
    PgClassExpression51{{"PgClassExpression[51∈5]<br />ᐸ__frmcdc_d...pe_1__.”f”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression51
    PgClassExpression52{{"PgClassExpression[52∈5]<br />ᐸ__frmcdc_d....”foo_bar”ᐳ"}}:::plan
    PgSelectSingle45 --> PgClassExpression52
    PgClassExpression91{{"PgClassExpression[91∈10]<br />ᐸ__frmcdc_d...pe_1__.”a”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression91
    PgClassExpression92{{"PgClassExpression[92∈10]<br />ᐸ__frmcdc_d...pe_1__.”b”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression92
    PgClassExpression93{{"PgClassExpression[93∈10]<br />ᐸ__frmcdc_d...pe_1__.”c”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression93
    PgClassExpression94{{"PgClassExpression[94∈10]<br />ᐸ__frmcdc_d...pe_1__.”d”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression94
    PgClassExpression95{{"PgClassExpression[95∈10]<br />ᐸ__frmcdc_d...pe_1__.”e”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression95
    PgClassExpression96{{"PgClassExpression[96∈10]<br />ᐸ__frmcdc_d...pe_1__.”f”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression96
    PgClassExpression97{{"PgClassExpression[97∈10]<br />ᐸ__frmcdc_d....”foo_bar”ᐳ"}}:::plan
    PgSelectSingle90 --> PgClassExpression97
    __Item38[/"__Item[38∈4]<br />ᐸ37ᐳ"\]:::itemplan
    PgClassExpression37 ==> __Item38
    __Item83[/"__Item[83∈9]<br />ᐸ82ᐳ"\]:::itemplan
    PgClassExpression82 ==> __Item83

    %% define steps

    subgraph "Buckets for mutations/v4/pg11.types"
    Bucket0("Bucket 0 (root)"):::bucket
    classDef bucket0 stroke:#696969
    class Bucket0,__Value0,__Value3,__Value5,Access28,Access29,Object30,Constant98,Constant99,Constant100,Constant105,Constant106,Constant111,Constant112 bucket0
    Bucket1("Bucket 1 (mutationField)<br />Deps: 30, 98, 99, 100, 111, 112<br /><br />1: PgUpdateSingle[27]<br />2: <br />ᐳ: Object[31]"):::bucket
    classDef bucket1 stroke:#00bfff
    class Bucket1,PgUpdateSingle27,Object31 bucket1
    Bucket2("Bucket 2 (nullableBoundary)<br />Deps: 31, 27, 30<br /><br />ROOT Object{1}ᐸ{result}ᐳ[31]"):::bucket
    classDef bucket2 stroke:#7f007f
    class Bucket2 bucket2
    Bucket3("Bucket 3 (nullableBoundary)<br />Deps: 27, 30<br /><br />ROOT PgUpdateSingle{1}ᐸtypes(id;regrole,regnamespace,bigint_domain_array_domain,domain_constrained_compound_type)ᐳ[27]<br />1: <br />ᐳ: 34, 35, 36, 37, 39<br />2: PgSelect[40]<br />ᐳ: First[44], PgSelectSingle[45]"):::bucket
    classDef bucket3 stroke:#ffa500
    class Bucket3,PgClassExpression34,PgClassExpression35,PgClassExpression36,PgClassExpression37,PgClassExpression39,PgSelect40,First44,PgSelectSingle45 bucket3
    Bucket4("Bucket 4 (listItem)<br />ROOT __Item{4}ᐸ37ᐳ[38]"):::bucket
    classDef bucket4 stroke:#0000ff
    class Bucket4,__Item38 bucket4
    Bucket5("Bucket 5 (nullableBoundary)<br />Deps: 45<br /><br />ROOT PgSelectSingle{3}ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ[45]"):::bucket
    classDef bucket5 stroke:#7fff00
    class Bucket5,PgClassExpression46,PgClassExpression47,PgClassExpression48,PgClassExpression49,PgClassExpression50,PgClassExpression51,PgClassExpression52 bucket5
    Bucket6("Bucket 6 (mutationField)<br />Deps: 105, 106, 3<br /><br />1: Access[73]<br />2: Access[74]<br />3: Object[75]<br />4: Constant[113]<br />5: Constant[114]<br />6: PgInsertSingle[72]<br />7: <br />ᐳ: Object[76]"):::bucket
    classDef bucket6 stroke:#ff1493
    class Bucket6,PgInsertSingle72,Access73,Access74,Object75,Object76,Constant113,Constant114 bucket6
    Bucket7("Bucket 7 (nullableBoundary)<br />Deps: 76, 72, 75<br /><br />ROOT Object{6}ᐸ{result}ᐳ[76]"):::bucket
    classDef bucket7 stroke:#808000
    class Bucket7 bucket7
    Bucket8("Bucket 8 (nullableBoundary)<br />Deps: 72, 75<br /><br />ROOT PgInsertSingle{6}ᐸtypes(regrole,regnamespace,bigint_domain_array_domain,domain_constrained_compound_type)ᐳ[72]<br />1: <br />ᐳ: 79, 80, 81, 82, 84<br />2: PgSelect[85]<br />ᐳ: First[89], PgSelectSingle[90]"):::bucket
    classDef bucket8 stroke:#dda0dd
    class Bucket8,PgClassExpression79,PgClassExpression80,PgClassExpression81,PgClassExpression82,PgClassExpression84,PgSelect85,First89,PgSelectSingle90 bucket8
    Bucket9("Bucket 9 (listItem)<br />ROOT __Item{9}ᐸ82ᐳ[83]"):::bucket
    classDef bucket9 stroke:#ff0000
    class Bucket9,__Item83 bucket9
    Bucket10("Bucket 10 (nullableBoundary)<br />Deps: 90<br /><br />ROOT PgSelectSingle{8}ᐸfrmcdc_domainConstrainedCompoundType_1ᐳ[90]"):::bucket
    classDef bucket10 stroke:#ffff00
    class Bucket10,PgClassExpression91,PgClassExpression92,PgClassExpression93,PgClassExpression94,PgClassExpression95,PgClassExpression96,PgClassExpression97 bucket10
    Bucket0 --> Bucket1 & Bucket6
    Bucket1 --> Bucket2
    Bucket2 --> Bucket3
    Bucket3 --> Bucket4 & Bucket5
    Bucket6 --> Bucket7
    Bucket7 --> Bucket8
    Bucket8 --> Bucket9 & Bucket10
    end
